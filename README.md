# golang-key-value-database

Брокер сообщений на Golang

# Шаги по запуску сервиса
1. Скопируйте и измените переменные окружения:
```
cp .env.example .env
```
2. Запустите API сервер
```
make run_api
```

# Swagger документация

[http://localhost:7000/swagger/index.html](http://localhost:7000/swagger/index.html)


# Для разработчиков
Запус линтеров
```
make lint
```
Запуск тестов
```
make test
```
Генерация swagger документации
```
make swag_format && make swag_generate
```
Генерация моков для тестов
```
make mock_generate
```

# Ссылка на задание
https://balun-team.yonote.ru/share/7cdbef47-10db-43ac-9274-0a2c69fccd12/doc/domashnee-zadanie-1-SpTsN92vFP

# Описание сервиса

## Архитектура

**Необходимо сразу закладываться на многослойную архитектуру** и ограждать каждый из слоев интерфейсами, так как в будущем будет добавляться много новой функциональности в виде отдельных слоев. На начальном этапе архитектура будет состоять из следующего:

- **compute** \[слой, отвечающий за обработку запроса\] 
  - **parser** - \[компонент внутри слоя, отвечающий за парсинг запросов\]
- **storage** \[слой, отвечающий за хранение и обработку данных\] 
  - **engine** - \[компонент внутри слоя, отвечающий за то, где и как хранятся данные\]


## Синтаксис запросов

Грамматика языка запросов в виде eBNF:

```javascript
query = set_command | get_command | del_command

set_command = "SET" argument argument
get_command = "GET" argument
del_command = "DEL" argument
argument    = punctuation | letter | digit { punctuation | letter | digit }

punctuation = "*" | "/" | "_" | ...
letter      = "a" | ... | "z" | "A" | ... | "Z"
digit       = "0" | ... | "9"
 
```

Пример запросов:

```javascript
SET weather_2_pm cold_moscow_weather
GET /etc/nginx/config
DEL user_****
```

То есть, синтаксис очень простой - **есть всего лишь три возможных команды** (*SET, GET, DEL - регистрозависимые*), **аргументами команд являются только следующая возможная комбинация** /(\\w+)/g , **разделителями являются любые пробельные символы**.


## Особенности реализации

- **Взаимодействие с базой данных на данном этапе должно осуществляться только лишь через командную строку**, то есть вы запускаете базу данных и взаимодействуете с ней через командую строку с использованием языка запросов. Никакие данные на жесткий диск сейчас дампить не нужно (*если вы сделали рестарт базы данных, то все данные должны будут пропасть*)
- **В качестве engine пишем in-memory движок**, который просто будет хранить данные в виде хэш-таблицы (*в качестве ключей и запросов только текстовые типы данных*)
- **Необходимо сразу задуматься над логированием**, поэтому следует логировать ключевые моменты обработки запросов (*в качестве библиотеки логирования можно выбрать zap*)
- **Покрываем код тестами**, особенно это касается компонентов parser внутри compute слоя и компонента engine внутри storage слоя



:::tip
Можно обращаться за примером [к этому репозиторию](https://github.com/Balun-courses/concurrency_go/tree/master/database), главное не стоит все там бездумно копировать - рекомендую обращаться к нему, как к референсу…

:::


:::info
Не забудь вернуться к [самостоятельной работе](https://balun-team.yonote.ru/share/87f296a0-48fa-44e0-b8ca-d0eea9d67a71/doc/samostoyatelnaya-rabota-vt5nM6MfRE), чтобы проверить, что можно изменить, улучшить или сделать по другому.

:::